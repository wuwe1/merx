---
name: 主题和颜色标志
status: open
created: 2026-02-04T02:46:28Z
updated: 2026-02-04T02:51:33Z
github: https://github.com/wuwe1/merx/issues/6
depends_on: [3, 5]
parallel: true
conflicts_with: []
---

# Task: 主题和颜色标志

## 描述

实现 --theme 标志和自定义颜色标志（--bg、--fg、--accent 等），支持 beautiful-mermaid 的主题系统。

## 验收标准

- [ ] `--theme tokyo-night` 使用内置主题
- [ ] `--bg "#1a1b26" --fg "#a9b1d6"` 自定义颜色
- [ ] 所有 7 个颜色标志工作：bg、fg、accent、line、muted、surface、border
- [ ] 配置文件中的自定义主题可通过 --theme 使用
- [ ] 无效主题名显示可用主题列表

## 技术细节

### 颜色标志定义
```typescript
// src/commands/render.ts
args: {
  theme: { type: 'string', description: '主题名称' },
  bg: { type: 'string', description: '背景色 (hex)' },
  fg: { type: 'string', description: '前景色 (hex)' },
  accent: { type: 'string', description: '强调色 (hex)' },
  line: { type: 'string', description: '线条色 (hex)' },
  muted: { type: 'string', description: '弱化文本色 (hex)' },
  surface: { type: 'string', description: '表面色 (hex)' },
  border: { type: 'string', description: '边框色 (hex)' }
}
```

### 主题解析
```typescript
// src/utils/theme.ts
export function resolveTheme(
  args: ThemeArgs,
  config: MerxConfig
): ThemeColors {
  // 1. 如果指定 --theme，使用内置或自定义主题
  if (args.theme) {
    const builtin = getBuiltinTheme(args.theme)
    if (builtin) return builtin

    const custom = config.themes?.[args.theme]
    if (custom) return custom

    throw new Error(`Unknown theme: ${args.theme}`)
  }

  // 2. 使用配置文件中的默认主题
  const base = getBuiltinTheme(config.theme) || {}

  // 3. 覆盖单独的颜色标志
  return {
    ...base,
    ...(args.bg && { bg: args.bg }),
    ...(args.fg && { fg: args.fg }),
    // ... 其他颜色
  }
}
```

## 依赖

- [ ] 任务 002 完成（render 命令）
- [ ] 任务 004 完成（配置系统）
- [ ] beautiful-mermaid 主题 API

## 工作量估算

- 规模：S
- 小时数：2-3
- 并行：true（与 006 可并行）

## 完成定义

- [ ] 所有颜色标志工作
- [ ] 内置主题可用
- [ ] 自定义主题可用
- [ ] 颜色覆盖工作
