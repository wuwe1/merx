---
name: 实现 SVG 渲染
status: open
created: 2026-02-04T08:11:54Z
updated: 2026-02-04T08:11:54Z
github:
depends_on: [001]
parallel: false
conflicts_with: [003]
---

# Task: 实现 SVG 渲染

## 描述

将 `src/commands/render.ts` 中的 SVG 占位符替换为真正的 `renderMermaid()` API 调用。

## 验收标准

- [ ] 导入 `renderMermaid` from 'beautiful-mermaid'
- [ ] 单文件模式调用 `renderMermaid(content, options)` 生成 SVG
- [ ] 批量模式同样调用真实 API
- [ ] 主题颜色正确传递给 API
- [ ] `echo "graph LR; A-->B" | merx render | head -1` 输出以 `<svg` 开头
- [ ] 输出通过 `xmllint --noout` 验证

## 技术细节

### 修改位置
`src/commands/render.ts` 中的两处占位符：

1. **批量模式**（约 95-110 行）
```typescript
// 替换前
result = `<!-- Mermaid diagram from ${f} -->...`

// 替换后
result = await renderMermaid(content, {
  bg: themeColors.bg,
  fg: themeColors.fg,
  accent: themeColors.accent,
  line: themeColors.line,
  muted: themeColors.muted,
  surface: themeColors.surface,
  border: themeColors.border
})
```

2. **单文件模式**（约 150-160 行）
```typescript
// 同样替换为 renderMermaid 调用
```

### 测试命令
```bash
npm run build
echo "graph LR; A-->B" | node dist/cli.mjs render > test.svg
head -1 test.svg  # 应该以 <svg 开头
xmllint --noout test.svg  # 应该无错误
open test.svg  # macOS 打开浏览器查看
```

## 工作量估算

- 规模：S
- 小时数：1
- 并行：false

## 完成定义

- [ ] 代码已修改
- [ ] 构建成功
- [ ] SVG 输出有效
- [ ] 浏览器可正确显示
